<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Pyramid - Elite Social Hierarchy</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>

  <!-- ============================================================
       FIREBASE CONFIG â€” put your real values here.
       Every .js file uses the global `db` variable set below.
       ============================================================ -->
  <script>
    const firebaseConfig = {
      apiKey:            "AIzaSyBs81OlYrQ1_HBUHJ3Tim1vT-2glHOZPbc",
      authDomain:        "pyramidgame2026.firebasestorage.app",
      projectId:         "pyramidgame2026",
      storageBucket:     "pyramidgame2026.firebaseapp.com",
      messagingSenderId: "302574478188",
      appId:             "1:302574478188:web:aded8d66bdd1f828da8949"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>

  <style>
    @import url("https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Inter:wght@300;400;500;600;700;800&display=swap");
    :root {
      --primary-gold:#ffd700; --secondary-gold:#ffa500;
      --accent-purple:#9333ea; --accent-pink:#ec4899;
      --accent-cyan:#06b6d4; --dark-bg:#0a0a0f; --card-bg:#1a1a24;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{background:linear-gradient(135deg,#0a0a0f 0%,#1a0a2e 50%,#0a0a0f 100%);background-attachment:fixed;color:#e5e5e5;font-family:"Inter",sans-serif;overflow-x:hidden;min-height:100vh}
    .cinzel{font-family:"Cinzel",serif}

    .bg-animate{position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(circle at 20% 50%,rgba(147,51,234,.1) 0%,transparent 50%),radial-gradient(circle at 80% 80%,rgba(236,72,153,.1) 0%,transparent 50%),radial-gradient(circle at 40% 20%,rgba(6,182,212,.05) 0%,transparent 50%);z-index:-1;animation:bgShift 20s ease-in-out infinite}
    @keyframes bgShift{0%,100%{opacity:.3}50%{opacity:.6}}

    .glass-card{background:rgba(26,26,36,.6);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.1);box-shadow:0 8px 32px rgba(31,38,135,.37),inset 0 1px 0 rgba(255,255,255,.1);transition:all .3s ease}
    .glass-card:hover{border-color:rgba(255,215,0,.3);box-shadow:0 12px 40px rgba(255,215,0,.2),inset 0 1px 0 rgba(255,255,255,.15);transform:translateY(-2px)}

    .gradient-text{background:linear-gradient(135deg,var(--primary-gold),var(--secondary-gold),var(--accent-pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .gradient-text-purple{background:linear-gradient(135deg,var(--accent-purple),var(--accent-pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}

    .title-badge{display:inline-block;padding:4px 12px;border-radius:20px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1px;animation:titleGlow 2s ease-in-out infinite}
    .title-legendary{background:linear-gradient(135deg,#ffd700,#ffa500);color:#000;box-shadow:0 0 20px rgba(255,215,0,.5)}
    .title-epic{background:linear-gradient(135deg,#9333ea,#ec4899);color:#fff;box-shadow:0 0 20px rgba(147,51,234,.5)}
    .title-rare{background:linear-gradient(135deg,#06b6d4,#3b82f6);color:#fff;box-shadow:0 0 15px rgba(6,182,212,.4)}
    .title-common{background:linear-gradient(135deg,#6b7280,#9ca3af);color:#fff;box-shadow:0 0 10px rgba(107,114,128,.3)}
    @keyframes titleGlow{0%,100%{filter:brightness(1)}50%{filter:brightness(1.2)}}

    .user-rank-card{position:relative;overflow:hidden}
    .user-rank-card::before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent);transition:left .5s}
    .user-rank-card:hover::before{left:100%}
    .rank-1{background:linear-gradient(135deg,rgba(255,215,0,.2),rgba(255,165,0,.1));border-color:var(--primary-gold)!important}
    .rank-2{background:linear-gradient(135deg,rgba(192,192,192,.15),rgba(169,169,169,.1));border-color:#c0c0c0!important}
    .rank-3{background:linear-gradient(135deg,rgba(205,127,50,.15),rgba(184,115,51,.1));border-color:#cd7f32!important}

    .btn-primary{background:linear-gradient(135deg,var(--primary-gold),var(--secondary-gold));color:#000;font-weight:700;padding:12px 24px;border-radius:12px;border:none;cursor:pointer;transition:all .3s ease;text-transform:uppercase;letter-spacing:1px;position:relative;overflow:hidden}
    .btn-primary::before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:rgba(255,255,255,.3);transform:translate(-50%,-50%);transition:width .6s,height .6s}
    .btn-primary:hover::before{width:300px;height:300px}
    .btn-primary:hover{transform:translateY(-2px);box-shadow:0 10px 30px rgba(255,215,0,.4)}

    .btn-secondary{background:rgba(147,51,234,.2);border:2px solid var(--accent-purple);color:var(--accent-purple);font-weight:600;padding:10px 20px;border-radius:10px;cursor:pointer;transition:all .3s ease;text-transform:uppercase;font-size:11px;letter-spacing:1px}
    .btn-secondary:hover{background:var(--accent-purple);color:#fff;transform:translateY(-1px);box-shadow:0 8px 20px rgba(147,51,234,.4)}
    .btn-gift{background:linear-gradient(135deg,#ec4899,#f97316);border:none;color:#fff}
    .btn-gift:hover{box-shadow:0 8px 20px rgba(236,72,153,.4)}

    .chat-container{background:rgba(10,10,15,.8);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.1);border-radius:20px;overflow:hidden}
    .chat-message{padding:12px 16px;border-radius:12px;margin-bottom:8px;max-width:85%;word-wrap:break-word;animation:messageSlide .3s ease-out}
    @keyframes messageSlide{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    .chat-message.own{background:linear-gradient(135deg,rgba(147,51,234,.3),rgba(236,72,153,.2));margin-left:auto;border:1px solid rgba(147,51,234,.3)}
    .chat-message.other{background:rgba(255,255,255,.05);margin-right:auto;border:1px solid rgba(255,255,255,.1)}
    .chat-message.system{background:linear-gradient(135deg,rgba(255,215,0,.2),rgba(255,165,0,.1));margin:0 auto;text-align:center;border:1px solid rgba(255,215,0,.3);font-weight:600}
    .chat-message.gift{background:linear-gradient(135deg,rgba(236,72,153,.3),rgba(249,115,22,.2));margin:0 auto;text-align:center;border:1px solid rgba(236,72,153,.4)}

    input:focus,select:focus,textarea:focus{outline:none;border-color:var(--primary-gold)!important;box-shadow:0 0 0 3px rgba(255,215,0,.1)}
    ::-webkit-scrollbar{width:8px}
    ::-webkit-scrollbar-track{background:rgba(255,255,255,.05)}
    ::-webkit-scrollbar-thumb{background:linear-gradient(135deg,var(--accent-purple),var(--accent-pink));border-radius:10px}
    ::-webkit-scrollbar-thumb:hover{background:linear-gradient(135deg,var(--primary-gold),var(--secondary-gold))}

    .admin-fab{position:fixed;bottom:2rem;right:2rem;width:60px;height:60px;background:linear-gradient(135deg,var(--primary-gold),var(--secondary-gold));border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:1000;box-shadow:0 8px 30px rgba(255,215,0,.5);transition:all .3s ease;animation:fabPulse 2s ease-in-out infinite}
    @keyframes fabPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05);box-shadow:0 12px 40px rgba(255,215,0,.7)}}
    .admin-fab:hover{transform:scale(1.1) rotate(90deg);box-shadow:0 12px 50px rgba(255,215,0,.8)}

    .bounty-target{border:2px solid #ef4444!important;background:linear-gradient(135deg,rgba(239,68,68,.2),rgba(220,38,38,.1))!important;animation:bountyPulse 1.5s infinite;position:relative}
    .bounty-target::after{content:"âš ï¸ WANTED";position:absolute;top:8px;right:8px;background:#ef4444;color:#fff;padding:4px 8px;border-radius:6px;font-size:10px;font-weight:700;letter-spacing:1px}
    @keyframes bountyPulse{0%,100%{box-shadow:0 0 10px rgba(239,68,68,.5)}50%{box-shadow:0 0 30px rgba(239,68,68,.8)}}

    .spinner{border:3px solid rgba(255,255,255,.1);border-top:3px solid var(--primary-gold);border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite}
    @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
    .fade-in{animation:fadeIn .6s ease-out}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}

    .status-online{width:10px;height:10px;background:#10b981;border-radius:50%;display:inline-block;animation:statusBlink 2s ease-in-out infinite;box-shadow:0 0 8px #10b981}
    .status-offline{width:10px;height:10px;background:#6b7280;border-radius:50%;display:inline-block}
    @keyframes statusBlink{0%,100%{opacity:1}50%{opacity:.5}}
    .last-online{font-size:9px;color:#9ca3af;font-weight:500}

    /* =========================================================
       WELCOME OVERLAY â€” auth.js adds/removes class "show"
       ========================================================= */
    #welcome-overlay{
      position:fixed;inset:0;z-index:5000;
      background:rgba(0,0,0,.85);backdrop-filter:blur(8px);
      display:none;
      flex-direction:column;align-items:center;justify-content:center;
      gap:1.5rem;padding:2rem;
    }
    #welcome-overlay.show{ display:flex; }

    /* =========================================================
       APP SCREEN â€” auth.js does classList.remove('hidden')
       Tailwind .hidden sets display:none.
       Once removed, our rule below takes over.
       ========================================================= */
    #app-screen{ display:none; flex-direction:column; min-height:100vh; }
    #app-screen:not(.hidden){ display:flex; }

    /* Header */
    .app-header{
      position:sticky;top:0;z-index:100;
      background:rgba(10,10,15,.85);backdrop-filter:blur(24px);
      border-bottom:1px solid rgba(255,255,255,.08);
      padding:.7rem 1.2rem;
      display:flex;align-items:center;justify-content:space-between;gap:1rem;
      flex-shrink:0;
    }
    .header-left{display:flex;align-items:center;gap:.75rem}
    .header-right{display:flex;align-items:center;gap:.75rem;flex-wrap:wrap}
    .stat-chip{
      display:flex;align-items:center;gap:.35rem;font-size:.78rem;color:#cbd5e1;
      background:rgba(255,255,255,.06);padding:.3rem .65rem;border-radius:9999px;
      border:1px solid rgba(255,255,255,.08);
    }
    .stat-chip .label{color:#64748b;font-size:.65rem;text-transform:uppercase;letter-spacing:.05em}
    .stat-chip .value{font-weight:700;color:#f1f5f9}

    /* Body grid */
    .app-body{
      flex:1;display:grid;
      grid-template-columns:1fr 380px;
      gap:1rem;padding:1rem;
      min-height:0;overflow:hidden;
    }
    @media(max-width:860px){.app-body{grid-template-columns:1fr;grid-template-rows:1fr 1fr}}

    /* Hierarchy column */
    .hierarchy-panel{display:flex;flex-direction:column;min-height:0;overflow:hidden}
    .hierarchy-panel>h2{flex-shrink:0;margin-bottom:.6rem;font-family:"Cinzel",serif;font-size:1.1rem;font-weight:700}
    #pyramid-list{flex:1;overflow-y:auto;display:flex;flex-direction:column;gap:.5rem;padding-right:4px}

    /* Chat column */
    .chat-panel{display:flex;flex-direction:column;min-height:0;overflow:hidden}
    .chat-panel>h2{flex-shrink:0;margin-bottom:.6rem;font-family:"Cinzel",serif;font-size:1.1rem;font-weight:700}
    .chat-panel .chat-container{flex:1;display:flex;flex-direction:column;min-height:0}
    #chat-box{flex:1;overflow-y:auto;padding:.8rem;display:flex;flex-direction:column;gap:.2rem}
    #typing-indicator{font-size:.7rem;color:#6b7280;font-style:italic;padding:.2rem .8rem;height:1.3rem;flex-shrink:0}
    #typing-indicator.hidden{visibility:hidden}
    .chat-input-row{
      display:flex;gap:.5rem;padding:.6rem .8rem;flex-shrink:0;
      border-top:1px solid rgba(255,255,255,.07);
    }
    .chat-input-row input{
      flex:1;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);
      border-radius:10px;padding:.55rem .8rem;color:#e2e8f0;font-size:.84rem;
    }
    .chat-input-row input::placeholder{color:#4a5568}
    .chat-input-row button{
      background:linear-gradient(135deg,var(--primary-gold),var(--secondary-gold));
      border:none;color:#000;font-weight:700;font-size:.72rem;
      text-transform:uppercase;letter-spacing:.08em;
      padding:.55rem 1rem;border-radius:10px;cursor:pointer;
      transition:transform .15s,box-shadow .15s;flex-shrink:0;
    }
    .chat-input-row button:hover{transform:translateY(-1px);box-shadow:0 4px 14px rgba(255,215,0,.35)}
  </style>
</head>
<body>
<div class="bg-animate"></div>

<!-- AUTH SCREEN -->
<div id="auth-screen" class="min-h-screen flex items-center justify-center px-4 py-12">
  <div class="max-w-6xl w-full grid md:grid-cols-2 gap-8">
    <div class="glass-card p-8 rounded-2xl fade-in">
      <div class="mb-6">
        <h2 class="cinzel text-3xl font-bold gradient-text mb-2">Join The Elite</h2>
        <p class="text-sm text-zinc-400">Enter the hierarchy. Prove your worth.</p>
      </div>
      <div class="space-y-4">
        <input id="auth-name" type="text" placeholder="Full Name" class="w-full bg-black/40 border border-zinc-700 p-3 text-sm rounded-xl focus:border-[#FFD700] transition-all" autocomplete="name"/>
        <div class="flex gap-2">
          <select id="auth-gender" class="flex-1 bg-black/40 border border-zinc-700 p-3 text-sm rounded-xl focus:border-[#FFD700] transition-all">
            <option value="">Gender</option><option value="Male">Male</option><option value="Female">Female</option><option value="Other">Other</option>
          </select>
          <input id="auth-roll" type="text" placeholder="Roll Number" class="w-1/2 bg-black/40 border border-zinc-700 p-3 text-sm rounded-xl focus:border-[#FFD700] transition-all"/>
        </div>
        <div class="flex gap-2">
          <input id="auth-class" type="text" placeholder="Class (e.g. 11)" class="flex-1 bg-black/40 border border-zinc-700 p-3 text-sm rounded-xl focus:border-[#FFD700] transition-all"/>
          <input id="auth-sec" type="text" placeholder="Section" class="w-1/4 bg-black/40 border border-zinc-700 p-3 text-sm rounded-xl focus:border-[#FFD700] transition-all" maxlength="1"/>
        </div>
        <input id="auth-email" type="email" placeholder="Email (optional)" class="w-full bg-black/40 border border-zinc-700 p-3 text-sm rounded-xl focus:border-[#FFD700] transition-all" autocomplete="email"/>
        <div class="relative">
          <input id="auth-pass" type="password" placeholder="Create password (min 8 chars)" class="w-full bg-black/40 border border-zinc-700 p-3 text-sm rounded-xl pr-20 focus:border-[#FFD700] transition-all" autocomplete="new-password" minlength="8"/>
          <button id="toggle-pass" type="button" class="absolute right-3 top-3 text-xs text-zinc-400 hover:text-[#FFD700] transition-colors font-medium">Show</button>
        </div>
        <button id="register-btn" class="w-full btn-primary cinzel relative z-10">Enter The Pyramid</button>
        <p class="text-rose-400 text-xs font-medium mt-2 flex items-center gap-2"><span>âš </span><span>Use your real name and roll number. Duplicates blocked.</span></p>
      </div>
    </div>
    <div class="glass-card p-8 rounded-2xl flex flex-col justify-between fade-in">
      <div>
        <h3 class="cinzel text-2xl gradient-text-purple mb-6">Secure Access</h3>
        <div class="space-y-4">
          <input id="login-name" type="text" placeholder="Full Name" class="w-full bg-black/40 border border-zinc-700 p-3 text-sm rounded-xl focus:border-[#FFD700] transition-all" autocomplete="username"/>
          <input id="login-pass" type="password" placeholder="Password" class="w-full bg-black/40 border border-zinc-700 p-3 text-sm rounded-xl focus:border-[#FFD700] transition-all" autocomplete="current-password"/>
          <button id="login-btn" class="w-full btn-primary cinzel relative z-10">Login</button>
        </div>
      </div>
      <div class="mt-8 pt-6 border-t border-zinc-800">
        <p class="text-[10px] text-zinc-500 text-center">By entering you agree to maintain dignity and respect within the hierarchy.</p>
      </div>
    </div>
  </div>
</div>

<!-- WELCOME OVERLAY â€” auth.js adds .show to display, removes .show to hide -->
<div id="welcome-overlay">
  <h1 id="welcome-title" class="cinzel text-4xl font-black gradient-text text-center">Welcome</h1>
  <p id="welcome-sub" class="text-zinc-400 text-center max-w-md">Your hierarchy awaits</p>
  <button id="welcome-proceed" class="btn-primary cinzel relative z-10" style="font-size:.82rem;padding:.65rem 2rem">Enter The Pyramid</button>
</div>

<!-- APP SCREEN â€” auth.js removes .hidden class to reveal -->
<div id="app-screen" class="hidden">
  <header class="app-header">
    <div class="header-left">
      <span class="cinzel gradient-text" style="font-size:1.05rem;font-weight:700">â¬¥ The Pyramid</span>
    </div>
    <div class="header-right">
      <div class="stat-chip"><span class="label">You</span><span class="value" id="my-name-display">â€”</span></div>
      <div class="stat-chip"><span class="label">Title</span><span class="value" id="my-title-display">Commoner</span></div>
      <div class="stat-chip"><span class="label">Credits</span><span class="value" id="my-credits-display">0</span></div>
      <div class="stat-chip"><span class="label">Votes</span><span class="value" id="votes-remaining-display">3</span></div>
      <button id="logout-btn" class="text-xs text-zinc-500 hover:text-red-400 transition-colors border border-zinc-700 hover:border-red-500 px-3 py-1.5 rounded-lg">Logout</button>
    </div>
  </header>
  <div class="app-body">
    <div class="hierarchy-panel">
      <h2 class="gradient-text">ðŸ‘‘ Hierarchy</h2>
      <div id="pyramid-list">
        <div class="text-center text-zinc-600 py-12"><div class="spinner mx-auto mb-3"></div>Loading hierarchyâ€¦</div>
      </div>
    </div>
    <div class="chat-panel">
      <h2 class="gradient-text">ðŸ’¬ Chat</h2>
      <div class="chat-container">
        <div id="chat-box"></div>
        <div id="typing-indicator" class="hidden"></div>
        <div class="chat-input-row">
          <input id="chat-input" type="text" placeholder="Type a messageâ€¦" autocomplete="off"/>
          <button id="send-chat">Send</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Admin FAB -->
<div id="admin-fab" class="admin-fab hidden" onclick="openAdminPower()">
  <span style="font-size:1.6rem">ðŸ‘‘</span>
</div>

<!-- Scripts in dependency order -->
<script src="auth.js"></script>
<script src="chat.js"></script>
<script src="voting.js"></script>
<script src="bounty.js"></script>
<script src="economy.js"></script>
<script src="admin.js"></script>
<script src="hierarchy-gift-buttons.js"></script>
</body>
</html>
