<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
</head>
<body class="bg-black text-white p-10">

    <div id="reg-box">
        <h1 class="text-[#d4af37] text-2xl mb-5">THE PYRAMID REGISTRATION</h1>
        <input id="reg-name" type="text" placeholder="Enter First Name" class="block w-full p-2 mb-4 bg-zinc-900 border border-zinc-700">
        <select id="reg-gender" class="block w-full p-2 mb-4 bg-zinc-900">
            <option value="">Select Gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
        </select>
        <button onclick="handleRegister()" class="bg-[#d4af37] text-black p-3 w-full font-bold">JOIN</button>
    </div>

    <script>
        // 1. YOUR FIREBASE KEYS (Get these from Firebase Console)
        const firebaseConfig = {
            apiKey: "AIzaSyBs81OlYrQ1_HBUHJ3Tim1vT-2glHOZPbc",
            authDomain: "pyramidgame2026.firebaseapp.com",
            projectId: "pyramidgame2026",
            storageBucket: "pyramidgame2026.firebasestorage.app",
            messagingSenderId: "302574478188",
            appId: "1:302574478188:web:aded8d66bdd1f828da8949"
        };

        // Initialize Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            var db = firebase.firestore();
            console.log("Firebase Linked!");
        } catch (e) {
            alert("Firebase Setup Error: " + e.message);
        }

        // 2. YOUR WHITELIST (Add your name here to test!)
        const classmateWhitelist = ["Ayush", "Anjali", "YourName"]; 

        async function handleRegister() {
            alert("Button Clicked!"); // This tells us the button works

            const nameInput = document.getElementById('reg-name').value.trim();
            const genderInput = document.getElementById('reg-gender').value;

            // Check if name is in list
            if (!classmateWhitelist.includes(nameInput)) {
                alert("Error: Name '" + nameInput + "' is not in the whitelist!");
                return;
            }

            try {
                // Try to save to Database
                await db.collection("users").doc(nameInput).set({
                    name: nameInput,
                    gender: genderInput,
                    credits: 100000,
                    title: "Commoner"
                });
                alert("Success! Account Created.");
                location.reload(); 
            } catch (error) {
                alert("Database Error: " + error.message);
                console.error(error);
            }
        }
    </script>
</body>
</html>
